function setActiveNav(){const nav=document.querySelector('.topnav nav');if(!nav)return;const links=[...nav.querySelectorAll('a[href^="#"]')];const ids=links.map(a=>a.getAttribute('href').slice(1));const sections=ids.map(id=>document.getElementById(id)).filter(Boolean);const map=new Map();links.forEach(a=>map.set(a.getAttribute('href').slice(1),a));const io=new IntersectionObserver((entries)=>{let best=null;for(const e of entries){if(!e.isIntersecting)continue;if(!best || e.intersectionRatio>best.intersectionRatio)best=e;}if(best){const id=best.target.id;links.forEach(a=>a.classList.remove('active'));const a=map.get(id);if(a)a.classList.add('active');}},{root:null,rootMargin:"0px 0px-60%0px",threshold:[0.2,0.4,0.6,0.8]});sections.forEach(s=>io.observe(s));}function animateCounters(){const els=document.querySelectorAll('.stat .big[data-count]');if(!els.length)return;const ease=t=>1-Math.pow(1-t,3);function run(el){const target=parseInt(el.getAttribute('data-count'),10);const hasPlus=/\+$/.test(el.textContent);const duration=900;const start=performance.now();function tick(now){const p=Math.min(1,(now-start)/duration);const val=Math.round(ease(p)*target);el.textContent=hasPlus?`${val}+`:`${val}`;if(p<1)requestAnimationFrame(tick);}requestAnimationFrame(tick);}const io=new IntersectionObserver((entries,obs)=>{entries.forEach(e=>{if(e.isIntersecting){run(e.target);obs.unobserve(e.target);}});},{threshold:0.6});els.forEach(el=>io.observe(el));}function enhanceCtaOutline(){document.querySelectorAll('.btn-outline').forEach(btn=>{btn.addEventListener('click',()=>{btn.style.boxShadow='0 0 0 6px rgba(255, 215, 0, .10)';setTimeout(()=>btn.style.boxShadow='',180);});});}document.addEventListener('DOMContentLoaded',()=>{setActiveNav();animateCounters();enhanceCtaOutline();});